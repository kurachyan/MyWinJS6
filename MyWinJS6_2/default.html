<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <meta charset="utf-8" />
    <title>MyWinJS6_2</title>

    <!-- WinJS 参照 -->
    <link href="//Microsoft.WinJS.2.0/css/ui-dark.css" rel="stylesheet" />
    <script src="//Microsoft.WinJS.2.0/js/base.js"></script>
    <script src="//Microsoft.WinJS.2.0/js/ui.js"></script>

    <!-- MyWinJS6_2 参照 -->
    <link href="/css/default.css" rel="stylesheet" />
    <script src="/js/default.js"></script>

    <script src="/js/localscript.js"></script>
    <script src="/js/Variable.js"></script>
    <!-- Script （前処理）-->
    <script>
/*      [vMap]
        var data = [-3, -1, -4, 1, 5, 9, 2, 6, 53, 589, 7932];
        function job(value, index, array) {
            return Math.abs(value);
        }
*/
        var data = ["A", "B", "C", "D", "E"];
        function connection(prev, value, index, array) {
            return prev + value;
        }
    </script>
</head>
<body>
<!---
            <p>コンテンツをここに挿入</p>
//--->

    <p>ＭｙＷｉｎＪＳ６＿２</p>

    <!--- Header --->
    <form name="myTime">
        <div id="timeinfo">登録時間を表示します。</div>
    </form>

    <!--- Body --->
    <!--- 詳細情報 --->
    <form name="myForm">
        <div id="result">詳細情報を表示します。</div>
    </form>

    <!--- Footer --->
    <form name="myFooter">
        <div id="footinfo">待機中です。</div><br>

        <input type="button" name="Boot" value="開始"
               onclick="BootJob()">
        <input type="button" name="Exit" value="終了"
               onclick="ExitJob()">
        <br>
        <input type="button" name="vAdd" value="ADD"
               onclick="vAddJob()">
    </form>

    <!-- Script -->
    <script>
        let local = new LocalTimerScript();
        let lvar = new LocalVariableScript

        function BootJob() {
            // 処理開始
            if (local.CheckTimer() == false) {      // タイマー未稼働？
                // タイマー稼働
                local.BootTimer();
                document.getElementById("footinfo").innerHTML = "Timer稼働中です。";

            } else {
                // 稼働済み
                document.getElementById("footinfo").innerHTML = "二重稼働は出来ません。";
            }
        }
        function ExitJob() {
            // 処理終了
            local.StopTimer();
            document.getElementById("footinfo").innerHTML = "待機中です。";
        }
        function vAddJob() {
            // 登録処理
            let ret = lvar.vAdd("data", "a");
            lvar.vAddList(0, "Text");
/*          [vExc]
            let r = lvar.vExc(0, 2, 3);
*/
/*          [vRed]
            let ret = lvar.vAdd("data", data);

            let r = lvar.vRed(0, connection);
*/
/*          [vMap]
            let ret = lvar.vAdd("data", data);

            let d = lvar.vMap(0, job);
*/
/*
            let ret = lvar.vAdd("list", [0, 1, 2, 3, 4, 5]);
            ret = lvar.vAdd("list2", 6);
*/
/*          [vDel] [vDup]
            let o5 = lvar.vDel();

            ret = lvar.vDup();
*/
/*          [Check] [vSet]
            ret = lvar.Check("list2");
            ret = lvar.vSet(ret, [7, 8]);
*/
        }
    </script>
</body>
</html>
